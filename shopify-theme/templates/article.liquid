{% comment %}
  Article Template
{% endcomment %}

<div class="article-page">
  <div class="container">
    <nav class="breadcrumb" role="navigation" aria-label="breadcrumbs">
      <a href="{{ routes.root_url }}">{{ 'general.breadcrumbs.home' | t | default: 'Home' }}</a>
      <span class="breadcrumb__separator"> › </span>
      <a href="{{ blog.url }}">{{ blog.title }}</a>
      <span class="breadcrumb__separator"> › </span>
      <span class="breadcrumb__current">{{ article.title }}</span>
    </nav>

    <article class="article">
      <header class="article-header">
        <h1 class="article-title">{{ article.title }}</h1>
        
        <div class="article-meta">
          <time datetime="{{ article.published_at | date: '%Y-%m-%d' }}">
            {{ article.published_at | date: format: 'month_day_year' }}
          </time>
          {%- if article.author != blank -%}
            <span class="article-author">by {{ article.author }}</span>
          {%- endif -%}
          {%- if article.tags.size > 0 -%}
            <div class="article-tags">
              {%- for tag in article.tags -%}
                <a href="{{ blog.url }}/tagged/{{ tag | handle }}" class="article-tag">#{{ tag }}</a>
              {%- endfor -%}
            </div>
          {%- endif -%}
        </div>
      </header>

      {%- if article.image -%}
        <div class="article-image">
          {{ article.image | image_url: width: 1200 | image_tag:
            alt: article.image.alt | escape
          }}
        </div>
      {%- endif -%}

      <div class="article-content rte">
        {{ article.content }}
      </div>

      <footer class="article-footer">
        <div class="article-share">
          <span class="article-share__label">Share this article:</span>
          <div class="article-share__buttons">
            <a href="https://www.facebook.com/sharer/sharer.php?u={{ article.url | url_encode }}" 
               target="_blank" 
               rel="noopener noreferrer"
               class="article-share__button">
              Facebook
            </a>
            <a href="https://twitter.com/intent/tweet?url={{ article.url | url_encode }}&text={{ article.title | url_encode }}" 
               target="_blank" 
               rel="noopener noreferrer"
               class="article-share__button">
              Twitter
            </a>
            <a href="https://pinterest.com/pin/create/button/?url={{ article.url | url_encode }}&description={{ article.title | url_encode }}" 
               target="_blank" 
               rel="noopener noreferrer"
               class="article-share__button">
              Pinterest
            </a>
          </div>
        </div>

        <div class="article-navigation">
          {%- if blog.previous_article -%}
            <a href="{{ blog.previous_article.url }}" class="article-nav article-nav--prev">
              <span class="article-nav__label">← Previous</span>
              <span class="article-nav__title">{{ blog.previous_article.title }}</span>
            </a>
          {%- endif -%}
          
          {%- if blog.next_article -%}
            <a href="{{ blog.next_article.url }}" class="article-nav article-nav--next">
              <span class="article-nav__label">Next →</span>
              <span class="article-nav__title">{{ blog.next_article.title }}</span>
            </a>
          {%- endif -%}
        </div>
      </footer>
    </article>

    {%- if blog.moderated? and comment.status == 'pending' -%}
      <div class="comment-pending">
        <p>{{ 'blogs.comments.moderated' | t | default: 'Your comment was posted successfully. We will publish it in a little while, as our blog is moderated.' }}</p>
      </div>
    {%- endif -%}

    {%- if number_of_comments > 0 -%}
      <div class="article-comments">
        <h3>{{ 'blogs.comments.with_count' | t: count: number_of_comments }}</h3>
        {%- paginate article.comments by 5 -%}
          <div class="comments">
            {%- for comment in article.comments -%}
              <div class="comment">
                <div class="comment-header">
                  <h4 class="comment-author">{{ comment.author }}</h4>
                  <time datetime="{{ comment.created_at | date: '%Y-%m-%d' }}">
                    {{ comment.created_at | date: format: 'month_day_year' }}
                  </time>
                </div>
                <div class="comment-content">
                  {{ comment.content }}
                </div>
              </div>
            {%- endfor -%}
          </div>
          
          {%- if paginate.pages > 1 -%}
            <nav class="pagination">
              {{ paginate | default_pagination }}
            </nav>
          {%- endif -%}
        {%- endpaginate -%}
      </div>
    {%- endif -%}

    {%- form 'new_comment', article -%}
      <div class="comment-form">
        <h3>{{ 'blogs.comments.title' | t | default: 'Leave a comment' }}</h3>
        
        {%- if form.posted_successfully? -%}
          <div class="form-success">
            {%- if blog.moderated? -%}
              <p>{{ 'blogs.comments.success_moderated' | t | default: 'Your comment was posted successfully. We will publish it in a little while, as our blog is moderated.' }}</p>
            {%- else -%}
              <p>{{ 'blogs.comments.success' | t | default: 'Your comment was posted successfully! Thank you!' }}</p>
            {%- endif -%}
          </div>
        {%- endif -%}

        <div class="form-fields">
          <div class="form-field">
            <label for="CommentAuthor">{{ 'blogs.comments.name' | t | default: 'Name' }}</label>
            <input type="text" name="comment[author]" id="CommentAuthor" class="form-input" 
                   value="{{ form.author }}" autocapitalize="words" required>
            {%- if form.errors contains 'author' -%}
              <span class="form-error">{{ 'blogs.comments.author' | t | default: 'Please enter your name.' }}</span>
            {%- endif -%}
          </div>

          <div class="form-field">
            <label for="CommentEmail">{{ 'blogs.comments.email' | t | default: 'Email' }}</label>
            <input type="email" name="comment[email]" id="CommentEmail" class="form-input" 
                   value="{{ form.email }}" autocorrect="off" autocapitalize="off" required>
            {%- if form.errors contains 'email' -%}
              <span class="form-error">{{ 'blogs.comments.email' | t | default: 'Please enter a valid email address.' }}</span>
            {%- endif -%}
          </div>

          <div class="form-field">
            <label for="CommentBody">{{ 'blogs.comments.message' | t | default: 'Message' }}</label>
            <textarea name="comment[body]" id="CommentBody" class="form-textarea" required>{{ form.body }}</textarea>
            {%- if form.errors contains 'body' -%}
              <span class="form-error">{{ 'blogs.comments.body' | t | default: 'Please enter a message.' }}</span>
            {%- endif -%}
          </div>

          {%- if blog.moderated? -%}
            <p class="comment-notice">{{ 'blogs.comments.moderated' | t | default: 'Please note, comments need to be approved before they are published.' }}</p>
          {%- endif -%}

          <button type="submit" class="btn comment-submit">
            {{ 'blogs.comments.post' | t | default: 'Post comment' }}
          </button>
        </div>
      </div>
    {%- endform -%}
  </div>
</div>

<style>
  .article-page {
    padding: 4rem 0;
  }

  .article {
    max-width: 800px;
    margin: 0 auto;
  }

  .article-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .article-title {
    font-size: 3rem;
    font-weight: 900;
    color: var(--primary-color);
    margin-bottom: 1rem;
  }

  .article-meta {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 2rem;
    flex-wrap: wrap;
    color: var(--text-light);
    font-size: 1rem;
  }

  .article-tags {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
  }

  .article-tag {
    padding: 0.25rem 0.75rem;
    background: var(--secondary-color);
    color: var(--primary-color);
    border-radius: 15px;
    text-decoration: none;
    font-size: 0.9rem;
    transition: all 0.3s ease;
  }

  .article-tag:hover {
    background: var(--primary-color);
    color: white;
  }

  .article-image {
    margin: 3rem 0;
    text-align: center;
  }

  .article-image img {
    max-width: 100%;
    height: auto;
    border-radius: 15px;
  }

  .article-content {
    font-size: 1.1rem;
    line-height: 1.8;
    margin-bottom: 3rem;
  }

  .article-footer {
    border-top: 2px solid var(--secondary-color);
    padding-top: 2rem;
    margin-bottom: 3rem;
  }

  .article-share {
    text-align: center;
    margin-bottom: 2rem;
  }

  .article-share__buttons {
    display: flex;
    justify-content: center;
    gap: 1rem;
    margin-top: 1rem;
  }

  .article-share__button {
    padding: 0.5rem 1rem;
    background: var(--primary-color);
    color: white;
    border-radius: 20px;
    text-decoration: none;
    transition: all 0.3s ease;
  }

  .article-share__button:hover {
    background: var(--text-dark);
    color: white;
  }

  .article-navigation {
    display: flex;
    justify-content: space-between;
    gap: 2rem;
  }

  .article-nav {
    flex: 1;
    padding: 1rem;
    background: var(--secondary-color);
    border-radius: 15px;
    text-decoration: none;
    color: var(--text-dark);
    transition: all 0.3s ease;
  }

  .article-nav:hover {
    background: var(--primary-color);
    color: white;
  }

  .article-nav--next {
    text-align: right;
  }

  .article-nav__label {
    display: block;
    font-size: 0.9rem;
    color: var(--text-light);
    margin-bottom: 0.5rem;
  }

  .article-nav__title {
    display: block;
    font-weight: 600;
  }

  .comment-form {
    max-width: 600px;
    margin: 3rem auto 0;
    padding: 2rem;
    background: var(--secondary-color);
    border-radius: 20px;
  }

  .form-field {
    margin-bottom: 1.5rem;
  }

  .form-field label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: var(--text-dark);
  }

  .form-input,
  .form-textarea {
    width: 100%;
    padding: 0.75rem 1rem;
    border: 2px solid transparent;
    border-radius: 10px;
    font-size: 1rem;
    transition: all 0.3s ease;
  }

  .form-input:focus,
  .form-textarea:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(83, 41, 166, 0.1);
  }

  .form-textarea {
    min-height: 120px;
    resize: vertical;
  }

  @media (max-width: 768px) {
    .article-title {
      font-size: 2rem;
    }
    
    .article-meta {
      flex-direction: column;
      gap: 1rem;
    }
    
    .article-navigation {
      flex-direction: column;
    }
  }
</style>